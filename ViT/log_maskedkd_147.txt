12/22/2024 10:34:20 - WARNING - __main__ - Process rank: 7, device: hpu, n_gpu: 0, distributed training: True
12/22/2024 10:34:20 - WARNING - __main__ - Process rank: 5, device: hpu, n_gpu: 0, distributed training: True
12/22/2024 10:34:20 - WARNING - __main__ - Process rank: 2, device: hpu, n_gpu: 0, distributed training: True
12/22/2024 10:34:21 - WARNING - __main__ - Process rank: 4, device: hpu, n_gpu: 0, distributed training: True
12/22/2024 10:34:21 - WARNING - __main__ - Process rank: 6, device: hpu, n_gpu: 0, distributed training: True
12/22/2024 10:34:21 - WARNING - __main__ - Process rank: 0, device: hpu, n_gpu: 0, distributed training: True
12/22/2024 10:34:21 - WARNING - __main__ - Process rank: 1, device: hpu, n_gpu: 0, distributed training: True
12/22/2024 10:34:21 - WARNING - __main__ - Process rank: 3, device: hpu, n_gpu: 0, distributed training: True
12/22/2024 10:34:33 - INFO - __main__ - classifier: token
hidden_size: 768
patches:
  size: !!python/tuple
  - 16
  - 16
representation_size: null
transformer:
  attention_dropout_rate: 0.0
  dropout_rate: 0.1
  mlp_dim: 3072
  num_heads: 12
  num_layers: 12

12/22/2024 10:34:33 - INFO - __main__ - classifier: token
hidden_size: 1024
patches:
  size: !!python/tuple
  - 16
  - 16
representation_size: null
transformer:
  attention_dropout_rate: 0.0
  dropout_rate: 0.1
  mlp_dim: 4096
  num_heads: 16
  num_layers: 24

12/22/2024 10:34:33 - INFO - __main__ - Training parameters Namespace(name='imagenet1k_TF', dataset='imagenet1K', model_type='ViT-B_16', teacher_model_type='ViT-L_16', pretrained_dir='checkpoint/ViT-B_16.npz', teacher_pretrained_dir='pretrained_models/ViT-L_16-224.npz', output_dir='output', img_size=224, train_batch_size=64, eval_batch_size=64, eval_every=1000, learning_rate=0.06, weight_decay=0, num_steps=20000, decay_type='cosine', warmup_steps=500, max_grad_norm=1.0, local_rank=0, seed=42, gradient_accumulation_steps=2, support_inaccurate_perf_test=False, loss_scale=0, data_path='/workspace/imagenet', cache_dataset=False, use_hpu=1, resume=None, run_lazy_mode=True, is_autocast=True, maskedkd=True, len_num_keep=147, log_path='log_maskedkd_147', n_gpu=0, device=device(type='hpu'))
12/22/2024 10:34:33 - INFO - __main__ - Total Parameter: 	86.6M
